require 'test_helper'

class Myclear::ServiceTest < Minitest::Test

  def test_bank_list_enquiry
    response_body = "fpx_msgToken=01&fpx_sellerExId=EX00000000&fpx_bankList=PBB0233%7EA%2CMBB0228%7EA%2CBKRM0602%7EA%2CABMB0212%7EA%2CMB2U0227%7EA%2CBIMB0340%7EA%2CBMMB0341%7EB%2CKFH0346%7EA%2CABB0233%7EA%2CUOB0229%7EB%2CRHB0218%7EA%2COCBC0229%7EA%2CSCB0216%7EB%2CHLB0224%7EA%2CTEST0023%7EA%2CTEST0022%7EA%2CTEST0021%7EA%2CUOB0226%7EB%2CBCBB0235%7EA%2CLOAD001%7EA%2CAMBB0209%7EA%2CBSN0601%7EA%2CHSBC0223%7EA&fpx_checkSum=0655D97F647E6012C6B6FF03C13C55A2A55BDE00E882EDEBF63EFB8B365944E044DDB58CE1DCDAD48A808AA8058A6333A698961AAC6A2FBD0C7D0987030F164CE85525DCF9BEFF0191F5503FF9234C6487CBE4A9299A47472489BFB628591ED5695F2C726065BBAC520F1587357008B40FFE44FA64CF0F5A38035D2829D6D4DD6CB68B5DB57F36901F61D358D00F13ADB548088D5657ECF6E12B6773CBE1AD7CA02A923F5A3443D37F6DE87754AB04ABCF9FBE689869C460717C38EEBD78294ECE8F6B5A48FBB8AEB978D8075658563F700F3C083C23CB164DD2A06C8E3A3F77379AD914E83F3CB5A2EC8389EB5C08A40962A1972886A1BECC6D3616349B5F4D&fpx_msgType=BC"
    stub_request(
      :post,
      'https://uat.mepsfpx.com.my/FPXMain/RetrieveBankList'
    ).to_return(body: response_body)

    assert_equal response_body, Myclear::Service.bank_list_enquiry.body
  end

  def test_be_url
    assert_equal 'https://uat.mepsfpx.com.my/FPXMain/RetrieveBankList', Myclear::Service.be_url
    Myclear.uat = false
    assert_equal 'https://mepsfpx.com.my/FPXMain/RetrieveBankList', Myclear::Service.be_url
    Myclear.uat = true
  end

end
